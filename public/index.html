<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My API Spotify</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <script src="path/to/my-script.js"></script>

    <style>
        body {
            padding-top: 5rem;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="row justify-content-center col-lg-6">
            <div id="login">
                <h1 class="mb-4 text-center">My 5 Top Artists</h1>
                <a class="btn btn-primary d-block mx-auto text-white" href="/login">Fetch Data</a>
            </div>
            <div id="logged-in" style="display:none">
                <h1>My Top Artists</h1>
                <div id="top-artists"></div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>

    <script>
        function getHashParams() {
            let hashParams = {};
            let e, r = /([^&;=]+)=?([^&;]*)/g,
                q = window.location.hash.substring(1);
            while (e = r.exec(q)) {
                hashParams[e[1]] = decodeURIComponent(e[2]);
            }
            return hashParams;
        }

        let params = getHashParams();

        let access_token = params.access_token;
        let refresh_token = params.refresh_token;
        let error = params.error;

        if (error) {
            alert('There was an error during the authentication');
        } else {
            if (access_token) {
                document.getElementById("login").style.display = "none";
                document.getElementById("logged-in").style.display = "block";

                fetch('/topartists', {})
                    .then(function (response) {
                        return response.json();
                    })
                    .then(function (data) {
                        let artists = data.map(function (artist) {
                            return artist;
                        });

                        let artistsContainer = document.getElementById("top-artists");
                        let artistsList = document.createElement("ul");

                        artists.forEach(function (artist) {
                            let artistItem = document.createElement("li");
                            artistItem.appendChild(document.createTextNode(artist));
                            artistsList.appendChild(artistItem);
                        });
                        artistsContainer.appendChild(artistsList);
                    })
                    .catch(function (error) {
                        console.log(error);
                    });
            } else {
                document.getElementById("login").style.display = "block";
                document.getElementById("logged-in").style.display = "none";
            };
        };
    </script>
    </script>
</body>

</html>